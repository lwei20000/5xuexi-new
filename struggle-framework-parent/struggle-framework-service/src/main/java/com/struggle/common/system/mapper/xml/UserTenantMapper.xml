<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.struggle.common.system.mapper.UserTenantMapper">

    <select id="selectByUserId" resultType="com.struggle.common.system.entity.Tenant">
        SELECT tenant_id,parent_id,tenant_name,tenant_full_name,tenant_logo
        FROM sys_tenant
        WHERE tenant_id IN (
            SELECT tenant_id
            FROM sys_user_tenant
            WHERE user_id = #{userId}
        )
          AND deleted = 0
    </select>
    <select id="selectByUserIds" resultType="com.struggle.common.system.entity.Tenant">
        SELECT t.tenant_id,t.parent_id,t.tenant_name,t.tenant_full_name,t.tenant_logo,b.user_id
        FROM sys_user_tenant b
        LEFT JOIN sys_tenant t ON t.tenant_id = b.tenant_id
        WHERE b.user_id in
        <foreach collection="userIds" open="(" close=")" separator="," item="userId">
            #{userId}
        </foreach>
        <!--租户数据权限 -->
        <if test="tenantIds != null and tenantIds.size()>0">
            AND b.tenant_id in
            <foreach collection="tenantIds" open="(" close=")" separator="," item="tenantId">
                #{tenantId}
            </foreach>
        </if>
        AND t.deleted = 0
    </select>


</mapper>
